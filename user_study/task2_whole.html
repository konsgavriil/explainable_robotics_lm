<!DOCTYPE html>
<html lang="en">
<link rel="stylesheet" type="text/css" href="style2.css">
<script src="https://assets.crowd.aws/crowd-html-elements.js"></script>
<link crossorigin="anonymous" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css"
    integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" rel="stylesheet" />
<script src="https://code.jquery.com/jquery-3.1.0.min.js"
    integrity="sha256-cCueBR6CsyA4/9szpPfrX3s49M9vUU5BgtiJj06wt/s=" crossorigin="anonymous"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"
    integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa"
    crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/lodash.js/2.4.1/lodash.min.js"></script>

<meta content="width=device-width,initial-scale=1" name="viewport" />
<section class="container" id="Relevancy">
    <div class="row">
        <div class="panel panel-primary"><a class="panel-heading" href="javascript:void(0);"
                id="collapseTrigger"><strong>Task
                    instructions</strong> <span class="collapse-text">(Click to expand)</span> </a>
            <div class="panel-body" id="instructionBody">
                In this user study, you will take on the role of an operator responsible for supervising an autonomous
                maritime robot.
                <ol>
                    <li>You will be presented with three different scenarios, each depicted in an image and accompanied
                        by a descriptive
                        narrative.</li>
                    <li>For each scenario, review the provided materials and select the explanation you believe most
                        effectively conveys the
                        events.</li>
                    <li>After completing all three scenarios, you will answer some closing questions to conclude the
                        study.</li>
                </ol>
                <br>
                Let the user study begin!
            </div>
        </div>
    </div>
    <input type="hidden" name="fake" />

    <div class="row">
        <div class="panel panel-info">
            <div class="panel-heading">
                <div class="panel-title">Scenario 1</div>
            </div>
            <div class="panel-body" id="scenario1Body">
                <div class="content">
                    <img alt="Scenario1">
                    <div class="text">
                        <h3>Scenario 1 Description</h3>
                        <p></p>
                    </div>
                </div>
                <div class="crowd-form-container">
                    <crowd-form answer-format="flatten-objects">
                        <p></p>
                        <crowd-radio-group id="scenario1Options">
                            <crowd-radio-button name="option1" id="scenario1Option1" value=""></crowd-radio-button>
                            <crowd-radio-button name="option2" id="scenario1Option2" value=""></crowd-radio-button>
                            <crowd-radio-button name="option3" id="scenario1Option3" value=""></crowd-radio-button>
                        </crowd-radio-group>
                        <crowd-button form-action="reset" id="answerButton1">Continue</crowd-button>
                        <crowd-button form-action="submit" hidden>Continue</crowd-button>
                    </crowd-form>
                </div>
            </div>
        </div>
    </div>

    <div class="row">
        <div class="panel panel-info">
            <div class="panel-heading">
                <div class="panel-title">Scenario 2</div>
            </div>
            <div class="panel-body" id="scenario2Body">
                <div class="content">
                    <img alt="Scenario2">
                    <div class="text">
                        <h3>Scenario 2 Description</h3>
                        <p></p>
                    </div>
                </div>
                <div class="crowd-form-container">
                    <crowd-form answer-format="flatten-objects">
                        <p></p>
                        <crowd-radio-group id="scenario2Options">
                            <crowd-radio-button name="option1" id="scenario2Option1" value=""></crowd-radio-button>
                            <crowd-radio-button name="option2" id="scenario2Option2" value=""></crowd-radio-button>
                            <crowd-radio-button name="option3" id="scenario2Option3" value=""></crowd-radio-button>
                        </crowd-radio-group>
                        <crowd-button form-action="reset" id="answerButton2">Continue</crowd-button>
                        <crowd-button form-action="submit" hidden>Continue</crowd-button>
                    </crowd-form>
                </div>
            </div>
        </div>
    </div>

    <div class="row">
        <div class="panel panel-info">
            <div class="panel-heading">
                <div class="panel-title">Scenario 3</div>
            </div>
            <div class="panel-body" id="scenario3Body">
                <div class="content">
                    <img alt="Scenario3">
                    <div class="text">
                        <h3>Scenario 3 Description</h3>
                        <p></p>
                    </div>
                </div>
                <div class="crowd-form-container">
                    <crowd-form answer-format="flatten-objects">
                        <p></p>
                        <crowd-radio-group id="scenario3Options">
                            <crowd-radio-button name="option1" id="scenario3Option1" value=""></crowd-radio-button>
                            <crowd-radio-button name="option2" id="scenario3Option2" value=""> </crowd-radio-button>
                            <crowd-radio-button name="option3" id="scenario3Option3" value=""></crowd-radio-button>
                        </crowd-radio-group>
                        <crowd-button form-action="reset" id="answerButton3">Continue</crowd-button>
                        <crowd-button form-action="submit" hidden>Continue</crowd-button>
                    </crowd-form>
                </div>
            </div>
        </div>
    </div>

    <div class="row">
        <div class="panel panel-info">
            <div class="panel-heading">
                <div class="panel-title">Closing Questions</div>
            </div>
            <div class="panel-body" id="closingBody">
                <crowd-form answer-format="flatten-objects">
                    <input type="hidden" name="questionHiddenInput" id="questionHiddenInput" value="" />
                    <!-- Satisfaction -->
                    <p> How satisfied are you with the explanations provided during this study?
                        <span class="d-inline-block" data-toggle="tooltip" data-placement="top">
                            <br>
                        </span>
                        <crowd-radio-group>
                            <crowd-radio-button name="very_satisfied_q1" value="Very satisfied">Very
                                satisfied</crowd-radio-button>
                            <crowd-radio-button name="Satisfied_q1" value="Satisfied">Satisfied</crowd-radio-button>
                            <crowd-radio-button name="somewhat_satisfied_q1" value="Somewhat satisfied">Somewhat
                                satisfied</crowd-radio-button>
                            <crowd-radio-button name="not_satisfied_q1" value="Not satisfied">Not
                                satisfied</crowd-radio-button>
                        </crowd-radio-group>
                    </p>
                    <!-- Good trait -->
                    <p> What did you like about the explanations you chose?</b>
                        <span class="d-inline-block" tabindex="0" data-toggle="tooltip" data-placement="top">
                            <br>
                        </span>
                        <crowd-radio-group>
                            <crowd-radio-button name="content_accuracy_q2" value="Content accuracy">Content
                                accuracy</crowd-radio-button>
                            <crowd-radio-button name="verbosity_q2" value="Verbosity">Verbosity</crowd-radio-button>
                            <crowd-radio-button name="syntax_q2" value="Syntax">Syntax</crowd-radio-button>
                            <crowd-radio-button name="explanation_style_q2" value="Explanation style">Explanation
                                style</crowd-radio-button>
                            <crowd-radio-button name="nothing_q2" value="Nothing">Nothing</crowd-radio-button>
                        </crowd-radio-group>
                    </p>
                    <!-- Bad trait -->
                    <p> Is there anything you did not like about the explanations you chose?
                        <span class="d-inline-block" data-toggle="tooltip" data-placement="top">
                            <br>
                        </span>
                        <crowd-radio-group>
                            <crowd-radio-button name="content_accuracy_q3" value="Content accuracy">Content
                                accuracy</crowd-radio-button>
                            <crowd-radio-button name="verbosity_q3" value="Verbosity">Verbosity</crowd-radio-button>
                            <crowd-radio-button name="syntax_q3" value="Syntax">Syntax</crowd-radio-button>
                            <crowd-radio-button name="explanation_style_q3" value="Explanation style">Explanation
                                style</crowd-radio-button>
                            <crowd-radio-button name="nothing_q3" value="Nothing">Nothing</crowd-radio-button>
                        </crowd-radio-group>
                    </p>
                    <!-- Context -->
                    <p> In what context would you find these explanations most useful?
                        <span class="d-inline-block" data-toggle="tooltip" data-placement="top">
                            <br>
                        </span>
                        <crowd-radio-group>
                            <crowd-radio-button name="objective_progression_q4" value="Objective progression">Objective
                                progression</crowd-radio-button>
                            <crowd-radio-button name="unexpected_events_q4" value="Unexpected events">Unexpected
                                events</crowd-radio-button>
                            <crowd-radio-button name="behaviour_change_q4" value="Behaviour change">Behaviour
                                change</crowd-radio-button>
                            <crowd-radio-button name="Nowhere_q4" value="Nowhere">Nowhere</crowd-radio-button>
                        </crowd-radio-group>
                    </p>
                </crowd-form>
            </div>
        </div>
    </div>
</section>

<style>
#collapseTrigger {
    color: #fff;
    display: block;
    text-decoration: none;
}

#submitButton {
    white-space: normal;
}

#PreliminaryBody {
    height: 350px;
}

#ClosingBody {
    height: 420px;
}

#instructionBody table {
    font-size: 14px;
    margin-top: 10px;
}

#instructionBody table caption {
    text-align: left;
    padding: 0 0 5px 0;
}

#taskBody table {
    font-size: 14px;
    margin-top: 10px;
}

#taskBody table caption {
    text-align: left;
    padding: 0 0 5px 0;
}

#choice {
    display: block;
    margin-top: 10px;
}

#custom-scroll {
    height: 500px;
    overflow-y: scroll;
}

.content {
    margin-bottom: 15px;
}

.question {
    margin-left: 15px;
    padding-left: 10px;
    border-left: double;
}

.radio:first-of-type {
    margin-top: -5px;
}

.ann {
    font-size: 20px;
}

.disp {
    font-size: 20px;
}

.ann>span.token {
    cursor: pointer;
}

.ann>span.token:hover {
    text-decoration: underline;
}

.ann>strong.annotation:hover {
    text-decoration: line-through;
}

.annotation {
    font-weight: normal;
    background-color: #EAD379;
}

.btn-ann {
    font-size: 10px;
}

input[disabled] {
    color: #000
}

#key-name {
    background-color: #EAD379;
}

.center {
    display: block;
    margin-left: auto;
    margin-right: auto;
    width: 50%;
}

.panel-body {
    display: flex;
    flex-direction: column;
    align-items: center;
    /* Center align the radio group */
}

.content {
    display: flex;
    align-items: flex-start;
    /* Align items to the start of the container */
    width: 100%;
    /* Ensure the content div takes the full width */
}

.content img {
    max-width: 60%;
    /* Adjust as needed */
    height: auto;
}

.text {
    padding-left: 20px;
    /* Space between image and text */
    max-width: 40%;
    /* Adjust as needed */
}

.crowd-form-container {
    width: 100%;
    text-align: center;
    /* Center align the form contents */
}
</style>

<script>
document.addEventListener('DOMContentLoaded', function () {
    var condition = -1;
    var conditions = [3, 1, 2];
    var content = $('#instructionBody');
    var trigger = $('#collapseTrigger');
    var closingBody = $('#closingBody');
    var scenario1 = $('#scenario1Body');
    var scenario2 = $('#scenario2Body');
    var scenario3 = $('#scenario3Body');
    const scenario1Body = document.getElementById('scenario1Body');
    const scenario2Body = document.getElementById('scenario2Body');
    const scenario3Body = document.getElementById('scenario3Body');
    const answerButton1 = document.getElementById('answerButton1');
    const answerButton2 = document.getElementById('answerButton2');
    const answerButton3 = document.getElementById('answerButton3');
    answerButton1.disabled = true;
    answerButton2.disabled = true;
    answerButton3.disabled = true;

    const randomIndex = Math.floor(Math.random() * 2);
    const images_a = ['https://zenodo.org/records/11214735/files/causal2.png', 'https://zenodo.org/records/11214735/files/counterfactual2.png', 'https://zenodo.org/records/11214735/files/contrastive1.png'];
    const images_b = ['https://zenodo.org/records/11214735/files/causal1.png', 'https://zenodo.org/records/11214735/files/counterfactual1.png', 'https://zenodo.org/records/11214735/files/contrastive2.png'];
    const descriptions_a = ['Gilda was loitering on the right side and is about to exchange its loiter area with Henry. At the moment, the vessel is moving towards point 1 that is located southwest of it using the same heading. At the moment, Gilda is away from any obstacles or vessels and does not need to modify its trajectory for avoidance.', 'On its way towards a loiter area, Henry stops at a specific location to perform a GPS fix. This means that the longitude and latitude of the vessel is staying the same, but its depth is decreasing as the vessel is moving towards the surface to receive a signal. Which of the following explanations do you prefer for answering the corresponding query?', "Alpha is moving towards the final waypoint of the survey (point 2) while avoiding an obstacle. Once, the vessel has visited all waypoints, it has to return back to its starting point to be retrieved. The following query asks why the vessel hasn't already activated its return behaviour.Please select the explanation that best answers the question."];
    const descriptions_b = ['Henry is performing a survey in a bowtie pattern and is moving towards point 2 that is located northwest of the vessel. Select the explanation that best describes the current state of the autonomous underwater vehicle.', "After finishing its survey, Alpha is moving towards its starting point for pick up. If it's return is cancelled, then the vessel is programmed to restart its survey again.Select the explanation that best describes this alternative outcome.", 'In this scenario, Gilda avoids obstacles and contact collision simultaneously. The vessel is programmed to solve these unexpected outcomes using predefined protocols. However, these protocols do not include an immediate return towards the starting point, unless if instructed by command and control. Select the explanation that best justifies why the vessel is not returning back.'];
    const options1_a = ["Gilda is currently in the process of loitering fast towards point 1 with a southwest heading. Since there is a new loiter area available, Gilda's active behavior is influenced to continue loitering rather than returning to the starting point.Additionally, there is an obstacle at a very far distance and another vessel at a far distance, so there is no need for Gilda to avoid them.", 'The vessel has pinpointed its position and is now ready to continue its mission.', 'Alpha still needs to visit point 2 before returning back to its starting point.'];
    const options2_a = ['Gilda is in the process of exchanging loiter areas with Henry. This means it will have to go through multiple obstacles and possibly avoid collision with another vessel.', "If the vehicle is at the surface and has received a GPS update, it means that the vessel has successfully surfaced to provide new GPS coordinates to the command and control. This indicates that the vessel is ready to continue its mission.", 'At the moment, Alpha is moving towards point 2 while avoiding obstacle A to accomplish its objective and stay safe. Once, the vessel has reached its next waypoint, then it will start returning back for recovery.'];
    const options3_a = ['Gilda is about to move towards the left side of the map and loiter around using a new set of waypoints.', 'If Henry is at the surface and has received a GPS update, then it should be able to move towards the loiter area and continue its mission.', "Alpha is currently deployed to perform its objective, which is to move towards point 2 with a northwest heading and at a very fast speed. However, there is an obstacle named obstacle_a nearby in the southeast direction. Since the obstacle is not resolved and the proximity is close, alpha has activated the waypt_survey,avoid_obstacle_avoid_obstacle_a behavior to survey the area while avoiding the obstacle. This behavior allows alpha to continue towards its objective while ensuring safety and avoiding the obstacle."];
    const options1_b = ["Henry is in transit towards point 2 in the northwest, conducting a survey while consistently maintaining an approved depth range. As a result, the vessel is moving very fast under sea level but with a southwest heading as it turns around.", 'If Alpha no longer returns for pick up, it will circle around and start moving between the waypoints again.', 'The vessel needs a command by the operators to return back. At the moment, the vessel continues to fulfill its objectives while avoiding obstacles and other vessels.'];
    const options2_b = ['Henry is performing a survey and moving towards waypoint 2.', "If Alpha is no longer returning to its starting position, it would continue surveying the area without any intention of going back. There are no obstacles present and all previous obstacles have been resolved.", 'Gilda has not been instructed yet to return back, as a result, it continues to loiter while replanning its trajectory.'];
    const options3_b = ['Henry is moving under the water towards point 2 that is located northwest while surveying an area.', "If Alpha's return state is deactivated, then the vessel will continue surveying the area while also avoiding any present obstacles.", "If Gilda were to return instead of loitering while avoiding obstacles and vessels, it would need a command to return to its starting point. This alternative behavior would interrupt its current behavior of loitering and collision avoidance."];
    const queries_a = ['Please select the causal explanation that you think explains these events the best:', 'What if the vehicle is at the surface and has received a GPS update?', 'Why is alpha surveying the area while avoiding obstacle_a instead of returning to its starting point?'];
    const queries_b = ['Please select the causal explanation that you think explains these events the best:', 'What if Alpha is no longer returning to its starting position?', 'Why not Return instead of loiter,avd_obstacles_avd_obstacles_ob_2,avd_obstacles_avd_obstacles_ob_3,avdcol_henry?'];
    var images = [];
    var descriptions = [];
    var queries = [];
    var options1 = [];
    var options2 = [];
    var options3 = [];
    // Images
    var scenario1Image = scenario1Body.querySelector('.content img');
    var scenario2Image = scenario2Body.querySelector('.content img');
    var scenario3Image = scenario3Body.querySelector('.content img');
    // Descriptions
    var scenario1Description = scenario1Body.querySelector('.text p');
    var scenario2Description = scenario2Body.querySelector('.text p');
    var scenario3Description = scenario3Body.querySelector('.text p');
    // Queries
    var scenario1Query = scenario1Body.querySelector('.crowd-form-container p');
    var scenario2Query = scenario2Body.querySelector('.crowd-form-container p');
    var scenario3Query = scenario3Body.querySelector('.crowd-form-container p');
    // Options
    var scenario1Option1 = document.getElementById('scenario1Option1');
    var scenario1Option2 = document.getElementById('scenario1Option2');
    var scenario1Option3 = document.getElementById('scenario1Option3');
    var scenario2Option1 = document.getElementById('scenario2Option1');
    var scenario2Option2 = document.getElementById('scenario2Option2');
    var scenario2Option3 = document.getElementById('scenario2Option3');
    var scenario3Option1 = document.getElementById('scenario3Option1');
    var scenario3Option2 = document.getElementById('scenario3Option2');
    var scenario3Option3 = document.getElementById('scenario3Option3');
    var scenarioImage = null;
    var scenarioDescription = null;
    var scenarioQuery = null;
    var scenarioOption1 = null;
    var scenarioOption2 = null;
    var scenarioOption3 = null;
    var answerButton = null;
    var sequence = 1;
    var qList = [];
    var selectedOption = null;
    const qHiddenInput = document.getElementById('questionHiddenInput');

    scenario1Option1.addEventListener('click', handleRadioClick);
    scenario1Option2.addEventListener('click', handleRadioClick);
    scenario1Option3.addEventListener('click', handleRadioClick);
    scenario2Option1.addEventListener('click', handleRadioClick);
    scenario2Option2.addEventListener('click', handleRadioClick);
    scenario2Option3.addEventListener('click', handleRadioClick);
    scenario3Option1.addEventListener('click', handleRadioClick);
    scenario3Option2.addEventListener('click', handleRadioClick);
    scenario3Option3.addEventListener('click', handleRadioClick);

    function handleRadioClick(event) {
        selectedOption = event.target.value;
        answerButton.disabled = false;
    }


    if (randomIndex === 0) {
        var series = 'a'
        images = images_a;
        descriptions = descriptions_a;
        queries = queries_a;
        options1 = options1_a;
        options2 = options2_a;
        options3 = options3_a;
    } else {
        var series = 'b'
        images = images_b;
        descriptions = descriptions_b;
        queries = queries_b;
        options1 = options1_b;
        options2 = options2_b;
        options3 = options3_b;
    }
    qList.push(series);
    closingBody.hide();
    scenario2.hide();
    scenario3.hide();
    selectScenario();


    $('.collapse-text').text('(Click to collapse)');
    trigger.click(function () {
        content.toggle();
        var isVisible = content.is(':visible');
        if (isVisible) {
            $('.collapse-text').text('(Click to collapse)');
        } else {
            $('.collapse-text').text('(Click to expand)');
        }
    });

    answerButton1.addEventListener('click', function () {
        qList.push(selectedOption);
        selectScenario();
        scenario1.hide();
        scenario2.show();
        scenario2.focus();
    });

    answerButton2.addEventListener('click', function () {
        qList.push(selectedOption);
        selectScenario();
        scenario2.hide();
        scenario3.show();
        scenario3.focus();
    });

    answerButton3.addEventListener('click', function () {
        scenario3.hide();
        closingBody.show();
        closingBody.focus();
        qList.push(selectedOption);
        qHiddenInput.value = qList;
    });

    function selectScenario() {
        condition = conditions.shift();
        qList.push(condition);
        focusOnBody();
        console.log(condition);
        switch (condition) {
            case 1:
                scenarioImage.src = images[0];
                scenarioDescription.textContent = descriptions[0];
                scenarioQuery.textContent = queries[0];
                scenarioOption1.textContent = options1[0];
                scenarioOption2.textContent = options2[0];
                scenarioOption3.textContent = options3[0];
                scenarioOption1.value = options1[0];
                scenarioOption2.value = options2[0];
                scenarioOption3.value = options3[0];
                qList.push(queries[0]);
                break;
            case 2:
                scenarioImage.src = images[1];
                scenarioDescription.textContent = descriptions[1];
                scenarioQuery.textContent = queries[1];
                scenarioOption1.textContent = options1[1];
                scenarioOption2.textContent = options2[1];
                scenarioOption3.textContent = options3[1];
                scenarioOption1.value = options1[1];
                scenarioOption2.value = options2[1];
                scenarioOption3.value = options3[1];
                qList.push(queries[1]);
                break;
            case 3:
                scenarioImage.src = images[2];
                scenarioDescription.textContent = descriptions[2];
                scenarioQuery.textContent = queries[2];
                scenarioOption1.textContent = options1[2];
                scenarioOption2.textContent = options2[2];
                scenarioOption3.textContent = options3[2];
                scenarioOption1.value = options1[2];
                scenarioOption2.value = options2[2];
                scenarioOption3.value = options3[2];
                qList.push(queries[2]);
                break;
            default:
                console.log("Unknown scenario.");
        }

        return null;
    }

    function focusOnBody() {
        switch (sequence) {
            case 1:
                scenarioImage = scenario1Image;
                scenarioDescription = scenario1Description;
                scenarioQuery = scenario1Query;
                scenarioOption1 = scenario1Option1;
                scenarioOption2 = scenario1Option2;
                scenarioOption3 = scenario1Option3;
                answerButton = answerButton1;
                break;
            case 2:
                scenarioImage = scenario2Image;
                scenarioDescription = scenario2Description;
                scenarioQuery = scenario2Query;
                scenarioOption1 = scenario2Option1;
                scenarioOption2 = scenario2Option2;
                scenarioOption3 = scenario2Option3;
                answerButton = answerButton2;
                break;
            case 3:
                scenarioImage = scenario3Image;
                scenarioDescription = scenario3Description;
                scenarioQuery = scenario3Query;
                scenarioOption1 = scenario3Option1;
                scenarioOption2 = scenario3Option2;
                scenarioOption3 = scenario3Option3;
                answerButton = answerButton3;
                break;
            default:
                console.log("Unknown scenario.");
        }
        sequence++;
        return null;
    }
});
</script>

</html>